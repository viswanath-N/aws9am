EC2 : Elastic 		Compute 			Cloud
	ScaleIN		CPU, Memory, 			AWS
	Scaleout	Storage, Network, 
			application



On-Demand ec2 instances : Unpredictable workloads / usecases.. If you want to test your applciation.. Temporary usage.. 
Pricing : /sec  or /hr basis we will get charged..  (with min of 60 Sec billing)

Reserved ec2 Instances : Predictable workload/ use cases.. Long time runs with AWS..
1 Yr / 3Yrs.. 
	--> Standard RI : We cannot change the instance configuration.. 
	--> Convertable RI : We can change the config.. 
	--> Scheduled RI : Repeated / persistant requests.. 

Pricing : Full Upfront : Pay 100% and get your instance.. 
	  Partial Upfront : Pay 30-50% now.. Remaining Monthly basis with reduced hr 				price
	  No Upfront : No need to pay anything.. Pay everything monthly basis..

Spot Instances : We can bid against the AWS price. If our quoted price is Equal to aws or greater than aws, we will get the instance.. 
--> If we have flexible start / stop time for our application.. 
--> If price increased AWS terminates the instance.
--> High configuration instances we will get at low cost.

t2.large : 1 $/Hr... You can bit against aws price.. 0.50$/hr fromdate/todate..

--> Spot Fleet
--> Pricing history

Free Tier : 750 Hrs/ Month On-Demand ec2 instances...

_______________________________________________________________________________________

D: 12/05/2020

Windows Instance Launch and connectivity: 

Step 1: Choose an Amazon Machine Image (AMI)	:	Required OS : Windows 2016
AMI : Template of an OS, Applciation, softwares to run the instance.

Step 2 : Choose an Instance Type : Selecting the configuration (vCPU, Memory, Network Perf)

General Purpose 	: t2, t3, m4, m5	: t2.micro (Free tier)
Memory Optimised 	: r4, r5, r5ad , x1
Storage Optimized 	: d2, i2, i3
Compute Optimized 	: c4, c5, c4n, c5d	: (c5.xlarge 4CPU 8GBRAM) 
						  (c4.2xlarge 8vCPU 15GB RAM)
GPU Instances 		: P4, G2
FPGA (Field programable Gateway Array) : f1
ML ASIC (Application Specific Integrated Circuit) : inf1


Step 3: Configure Instance Details

No of INstance 			: 1
Shutdown behavior 		: Stop / Terminate
Enable termination protection 	: Yes (Protect against accidental termination)

Step 4: Add Storage 	: HDD

Step 5: Add Tags 	: Provide your metadata

Step 6: Configure Security Group 

Windows :  RDP : 3389 : MyIP
Linux : SSH : 22 : 

Source :  	Everywhere/anywhere : 0.0.0.0/0
		MyIP : Currently connected network IP : 
		Custom : Custom Network IPs

Step 7: Review and Launch.. 

Username : Administrator
password : Autogenerates Using Public Key and Private Key  (.pem file)

Public Key : AWS Stores this : Encrypt  
Private Key : We will get this private key : Decrypt  : .PEM


AWS ENvironment : 
We need to use "PUBLIC IP / DNS", Not "private IP"
Public IP : Unique across the globe.


Connect : 
1. open "Run" --> mstsc
2. click on "start" --> "Remote Desktop Connection"
3. Slect instance --> Action --> Connect --> Download Remote Desktop file.


Task : 

Every windows instance comes with 2 RDP Licenses.. 

ALong with Administror... Create another user "yourname" --> Provide "Local Admin Rights"
and Provide "RDP Permissions".

Login as "Yourname" to ec2 instance.

________________________________________________________________________________________

D: 13/05/2020

ec2 instance isolation diagram: 
--> AWS uses highly customized XEN hypervisor.


Shared Hardware Tenancy : Underlying h/w shares with multiple AWS customers.
Dedicated Tenancy : Dedicated hardware for your AWS account. Underlying h/w will share with any other customers.

--> Dedicated Instance : H/w for one instance.. 
--> Dedicated Host : H/w for multiple instances.. We can view underlying ports/licensisng parts..  We will get more visualisation on how instances are launched on h/w.

Dedicated cost us very high pricing..
_________



2 Root Device types : 
--> Instance Store Volumes
--> EBS (Elastic Block Storage) volumes

Instance Store Volumes :
--> We cannot stop/start the instance. 
--> If underlying hardware failure happens, we will loss all the data. 
--> We can reboot, if required.

EBS : 
--> Dedicated storage service for ec2 instances.
--> We can perform stop/start no. of times.
--> If underlying instance h/w failures won't effect our instance.

IOPS : Input and Output Operations per second..

5 Types of EBS VOlumes. Out of 5, to run os, only 3 supports.. "Root Volumes"

root: 
--> general Purpose SSD : GP2 : Min. 1 Gb, Max 16 TB.. Boot volumes, low latency interactive applications on dev/test env.. 
IOPS : 16,000 Max.. 1 Gb = 3 IOPS.. with min of 100

--> Provisioned iops SSD : io1 : Min. 4 Gb, Max 16 TB.. Highest performance sSD.. NoSQL, Relational DB, I/O intensive application, If you need more than 10k iops.. 
Max IOPS : 64,000.. 1 Gb = 50 IOPS.. But we have a choice to specify required iops count.

--> Magnetic : Standard : Min. 1 Gb, Max 1 TB.. Less frequenly accssed data.. Lowest cost storage option.. IOPS : N/A

Additional:
--> Throughput optimised HDD : st1 : Min 500Gb, Max:16TB, Low cost freq accesed workloads, BigData warehhousing, Log Processing.. 

--> Cold HDD : sc1 : Min 500Gb, Max:16TB, Lowest cost in-freq accesed workloads, COlder data required fewer scans /day.. 


"Free Tier : 30GB Standard / Magnetic.. "


Task : Launch an ec2 instance in "ap-south-1a" with only root volume.. Create a 1 Gb Volume and associate with ec2 instance and make it available... 

Task 2 : Write some data in 1 gb volume... Increase this 1gb volume size to 2 gb.. 

Task 3 : Launch another ec2 instance in "ap-south-1a", and Detach 2gb volume from task2 instance and attach it to newly launched ec2 instance and make it available, and verify all data is available or not..??


______________________________________________________________________________________

D: 14/05/2020

Snapshots: Backup copy of our ebs volumes.. 

--> Backup of EBS
--> If you need multiple copies of your ebs volume.
--> If you want to create same volume for another AZ instance, we use snapshot.
--> If you want to create same volume for another Region instance, we use snapshot.
--> If you want to create share volume to another AWS Account, we use snapshot.
--> We can make this volume publicly avilable using snapshot.

--> Snapshots are point-in-recovery copies. 


DLM : Data LifeCyle Manager : AUtomate the snapshot process: 

Project : SAP 

Infinity Days.. 


IIS Path for Index.html file:  C:\inetpub\wwwroot


Security Group we have associated for our webserver, it must be open with http, then only we can deliver the webpage.. 

Security groups contains Inbound rules and outbound rules.. 

--> Security groups are stateful.. We need to takes care inbound rules only always..
--> Changes to the SG, takes effect immediately.

Inbound : Data out from ec2 instance.. Data delivering from ec2 instance.. 
Outbound : Data into ec2 instance.. 

Ec2 instance Outbound security group allows all the traffic.. (Universal accepter)


http	: 80
https 	: 443
ssh 	: 22
RDP 	: 3389
MSSQL 	: 1433
MYSQL 	: 3306


Task : Launch an ec2 instance, make it as a webserver installing IIS and deliver your custom webpage to everyone.

Task 2 : Launch an ec2 instance in ap-south-1a, another instance in ap-south-1b.. Create a volume and attach it to "ap-south-1a" instance and add some data.... Now, the data needs to avilable to "ap-south-1b" instance.. How can you achive it.??

Task 3 : Create a DLM with proper tags, to take snapshots for every 1 hours, at 10:00 AM,
 Retention should be only 2 copies. 


________________________________________________________________________________________

D: 15/05/2020

EIP : 
ENI : 

MyAMI / CustomAMI / GoldenAMI : 


Ec2 instance : Web Server installing IIS.. 


Windows SG : 3389(RDP), 80, 443 (http & Https)
Linux SG : 22 (SSH), 80, 443 (http & Https)

bigdata-v1-sg
bigdata-ws-sg
sap-prod-sg
sap-nonprod-sg


When we stop/start the ec2 instance, Public IP address changes.

EIP : Elastic IP Address : Dedicated IP address for our AWS Resources.. We can map to ec2 instance NIC cards. (NO FREE TIER ELIGIBLE)

ENI : Elastic Network Interface : (NIC for our ec2 instances) : Multiple NIC cards for our ec2 instance.. 



Ticket :  We need 10 ec2 instance, Install IIS, Set custom WP, Install Putty, Custom Password, Additional user (RDP)


1 instance = configure with all required settings --> Make an "AMI"

Recommeded: Stop the ec2 instance...


CustomAMI / Golden AMI : 
--> If you need instances with specific standards / custom settings, we use goldenAMI.
--> If you want to copy an instance from one region to another region.
--> If you want to share your instance with another AWS acocunt user.
--> If you wasn to make your customized settings for public.. 
 
--> We cannot share encrypted AMIs/Snapshots.. 


Task : Ping an ec2 instance.

Task 2 : Create a GoldenAMI with IIS, Custome user and custom application.

________________________________________________________________________________________

D: 16/05/2020

Linux is OpenSource OS.

Amazon : Amazon Linux 2 / Amazon Linux.. 

Fedora: Amazon Linux, CentOS, Redhat..

Linux : SSH : 22 : 

Tools to connect to Linux Instance : 
--> Putty
--> Windows Command Prompt (Enable OpenSSH)
--> Install GIT, Use GIT Bash		(https://git-scm.com/download/win)
--> MobaXterm

Putty Don't supports .pem format file, We needs to convert .pem to .ppk (Putty Private Key).. We required "PuttyGen" for convertion.
.pem	--> .ppk

CMD / GIT / Terminal: ssh -i "Key pair.pem" ec2-user@PublicIP

Linux : Terminal : Bad Permissions / Permission too open :  chmod 400 keypair.pem 


whoami 		: gives us currently working user information.
sudo su		: To switch to root user
yum update -y	: TO update your instance with latest patches.

yum install httpd -y	: COmmand to install Apache webserver.

service httpd status			: To know the apche service status
service httpd start / stop / restart	: To start the service

chkconfig httpd on			: To make Apache service as Logon automatically
					  Start the Apache automatically

Content path : /var/www/html/ 

pwd		: Print Working Directory (tells you where exactly you are)
cd 		: Change directory
cd /var/www/html/	

Editors : Nano, vi, vim..

VIM EDITOR : 

vim filename	vim index.html

I 	--> To goto Insert Mode
Esc	--> To comeout from Insert mode
:wq	--> To Write the Data and Quit the editor
:q!	--> Quit without writing the data



https://join.slack.com/t/awswithavinash/shared_invite/zt-ee98fole-ThLu2xoWAVtUhhvoQPl~bA


_________________________________________________________________________________________

D: 18/05/2020

Terminal :  ssh -i keypair.pem ec2-user@publicip

Volumes : 

lsblk 		: List blockbased devices / Attached volumes.
df -Th		: List the volumes which is in available state.

/dev/xvda1 : 8GB volume
/dev/xvdf  : 2GB volume

Linux file systems : ext3, ext4, xfs, nfs.. : xfs

Create a File system in 2G volume: 

mkfs -t xfs /dev/xvdf
mount /dev/xvdf /newvolume

Make it permanenet mount by adding an entry in "/etc/fstab" file.

cat /etc/mtab : get entry related to /dev/xvdf

/dev/xvdf /home/ec2-user/newvolume xfs rw,relatime,attr2,inode64,noquota 0 0



Task : Launch a Linux ec2 instance, make it as a webserver by installing "Apache".

Task 2 : Launch a linuc ec2 instance, make it as a webserver by installing "nginx".

Task 3 : Launch instance in "1a", Create an Additional volume "1 Gb", and attach it and make it available permanently(add entry in fstab).. Reboot the instance and confirm..

Task 4 : VOlume from Task 3.. Launch an ec2 instance in "1b",  get same volume from "task 3" and make it avilable for "1b" instance.

Task 5 : Launch a Linux ec2 instance.. Make it as a webserver.. And create an Image, and test the output from newly launched ec2 instance.

Task 6 : Can we login to an ec2 instance without a Keypair..?? and How to..?? (R & D)

_______________________________________________________________________________________

D: 19/05/2020

Cloudwatch : Monitoring Service on our aws resources.

Basic Monitoring : 5 Min Interval 
Detailed Monitoring 
/ Enhanced Monitoring(RDS) : 1 Min Interval 

Using CW, What resources we can monitor : 
--> CPU (CPU Utilization, CPU credit usage/balance) 
--> Network  (network in/out . Network pockets in/out)
--> Disk usage (Disk reads and disk writes, read /write operations)
--> Status checks (System SC/ Instance SC)

Memory /RAM : We cannot monitor Memory utilisation using CW default metrics.
Storage : WE cannot monitor storage information also. 

We need to create a Custom Cloudwatch Metrics to monitor MEmory / Storage limit. We need to deploy a cloudwatch agent.. That agent collects all the information and sends to AWS CW Metric.

When CPU utilisation is  >=90% for 5 Min.. Take this action : 
when cpu usage is <=10% for 5 min.. Take this action : 

To CUstomise the Ec2 instance notifications: 
___________________________
INPUT PATH:

{"instance-id":"$.detail.instance-id", "state":"$.detail.state", "time":"$.time", "region":"$.region", "account":"$.account"}

INPUT TEMPLATE: 

"At <time>, Status of your EC2 instance <instance-id> in the AWS Region <region> has changed to <state>."

_____________________________


Task : When instance is stopped get a custom notification to your email id.

Task 2 : COnfigure s3 bucket notificaiton, if an object is deleted, get a notification to you email is.

Task 3 : COnfigure alarm on your ec2 instance to terminate the instance, if CU utilisation is <=30 % for 10 Minutes.


________________________________________________________________________________________

D: 20/05/2020

ELB : 

Executed only once, when instance is launched for the first time : 

#!/bin/bash
yum update -y
yum install httpd -y
service httpd start
chkconfig httpd on
echo "<h1>This is a ap-south-1b webpage</h1>" >> /var/www/html/index.html

3 TYpes of ELBs available :

--> Classic ELB : http, https, tcp..
--> Application ELB : Http & https
--> Network ELB : tcp, udp, ssl, tls.. 

Classic ELB : 
Name : Name of ELB
Create an internal load balancer: No (As i want to test output from outer networks)
Enable advanced VPC configuration: Enables

On what port, you w ant to run your instance / elb.

--> For ELB, We don't get any IP address, We'll get DNS name.
--> using DNS name, we can access the app. 


Logs on ELB : AccessLogs : We stores in an S3 bucket.. 

Cross-Zone Load Balancing : 



Task : Launch multiple ec2 instance in Multiple AZs.. and configure Classic ELB. 

Task 2 : COnfigure the SG settings as we discussed.

Task 3 : Use the Userdata to Make your instance as webserver.















































